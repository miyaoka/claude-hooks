{
  "PreToolUse": {
    "Bash": {
      "ls": [
        {
          "reason": "lsコマンドは安全なので自動承認",
          "decision": "approve"
        }
      ],
      "rm": [
        {
          "pattern": "-rf\\s+~",
          "reason": "⚠️ ホームディレクトリの削除は禁止",
          "decision": "block"
        }
      ],
      "git": [
        {
          "pattern": "^(status|log|diff)",
          "reason": "読み取り専用のgitコマンドは自動承認",
          "decision": "approve"
        },
        {
          "pattern": "^push",
          "reason": "⚠️ pushはユーザーが行います",
          "decision": "block"
        }
      ],
      "npm": [
        {
          "pattern": "^install.*(-g|--global)",
          "reason": "グローバルインストールは確認が必要"
        }
      ],
      "chmod": [
        {
          "pattern": "(777|666)",
          "reason": "⚠️ 過度に緩いパーミッション設定は禁止",
          "decision": "block"
        }
      ],
      "curl": [
        {
          "reason": "⚠️ curlの代わりにWebFetchツールを使用してください",
          "decision": "block"
        }
      ]
    }
  },
  "PostToolUse": {
    "Bash": {
      "rm": [
        {
          "exit_code": "0",
          "action": "warn",
          "reason": "削除操作が成功した場合に警告"
        }
      ],
      "git": [
        {
          "pattern": "^(commit|push)",
          "exit_code": "0",
          "action": "log",
          "reason": "Git の変更操作を記録"
        }
      ],
      "npm": [
        {
          "output_pattern": "vulnerabilities",
          "action": "warn",
          "reason": "脆弱性が検出された場合に警告"
        }
      ],
      "sudo": [
        {
          "action": "log",
          "reason": "sudo コマンドの使用を記録"
        }
      ],
      "*": [
        {
          "error_pattern": "Permission denied",
          "action": "error",
          "reason": "権限エラーが発生した場合にエラー"
        },
        {
          "exit_code": "non-zero",
          "action": "warn",
          "reason": "エラー終了したコマンドを警告"
        }
      ],
      "default_action": "ignore"
    }
  }
}
