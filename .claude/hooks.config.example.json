{
  "PreToolUse": {
    "Bash": [
      {
        "command": "ls",
        "decision": "approve",
        "reason": "lsコマンドは安全なので自動承認"
      },
      {
        "command": "rm",
        "args": "-rf\\s+~",
        "decision": "block",
        "reason": "⚠️ ホームディレクトリの削除は禁止"
      },
      {
        "command": "git",
        "args": "^(status|log|diff)",
        "decision": "approve",
        "reason": "読み取り専用のgitコマンドは自動承認"
      },
      {
        "command": "git",
        "args": "^push",
        "decision": "block",
        "reason": "⚠️ pushはユーザーが行います"
      },
      {
        "command": "npm",
        "args": "^install.*(-g|--global)",
        "reason": "グローバルインストールは確認が必要"
      },
      {
        "command": "chmod",
        "args": "(777|666)",
        "decision": "block",
        "reason": "⚠️ 過度に緩いパーミッション設定は禁止"
      },
      {
        "command": "curl",
        "decision": "block",
        "reason": "⚠️ curlの代わりにWebFetchツールを使用してください"
      }
    ]
  },
  "PostToolUse": {
    "Bash": [
      {
        "command": "rm",
        "action": "log",
        "reason": "削除操作を記録"
      },
      {
        "command": "rm",
        "args": "-rf\\s+\\.\\.",
        "action": "block",
        "reason": "⚠️ 親ディレクトリへの再帰的削除が実行されました。意図しない削除の可能性があるため処理を中断します"
      },
      {
        "command": "git",
        "args": "^(commit|push)",
        "action": "log",
        "reason": "Git の変更操作を記録"
      },
      {
        "command": "npm",
        "stdout": "vulnerability",
        "action": "log",
        "reason": "脆弱性が検出された場合に記録"
      },
      {
        "command": "sudo",
        "action": "log",
        "reason": "sudo コマンドの使用を記録"
      },
      {
        "command": "echo",
        "args": "log",
        "action": "log",
        "reason": "ログ出力を記録"
      },
      {
        "command": "find",
        "args": "-delete",
        "action": "log",
        "reason": "findコマンドで-deleteオプションが使用されました"
      },
      {
        "command": "chmod",
        "args": "-R"
      },
      {
        "stdout": "(password|secret|api_key|token)\\s*[:=]\\s*\\S+",
        "action": "block",
        "reason": "⚠️ 機密情報が出力に含まれています！安全のため処理を中断します"
      },
      {
        "args": "^(DROP|TRUNCATE)\\s+(TABLE|DATABASE)",
        "action": "block",
        "reason": "⚠️ データベースの破壊的操作が実行されました！後続処理を中断します"
      },
      {
        "stderr": "Permission denied",
        "action": "log",
        "reason": "権限エラーが発生しました"
      }
    ]
  }
}